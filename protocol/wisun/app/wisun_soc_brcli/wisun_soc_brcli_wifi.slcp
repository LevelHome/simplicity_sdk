project_name: "wisun_soc_brcli_wifi"
label: "Wi-SUN - SoC Border Router CLI with Wi-Fi connectivity"
description: "The Wi-SUN Border Router CLI (Command-Line Interface) sample application allows developers to easily evaluate the Wi-SUN stack APIs.
The Wi-SUN command line interface provides a serial interface to a number of the Wi-SUN stack functions.
For example, it can be used to create a Wi-SUN network and then to connect and exchange IP packets with Wi-SUN devices."
package: "wisun"
category: "Wi-SUN Examples"
quality: "evaluation"

sdk_extension:
  - id: wiseconnect3_sdk
    version: 3.4.0

component:
  - id: "wisun_br_stack"
  - id: "wisun_default_phy"
  - id: "wisun_configuration"
  - id: "wisun_stack_debug"
  - id: "sl_system"
  - id: "device_init"
  - id: "slist"
  - id: "freertos"
  - id: "sleeptimer"
  - id: "nvm3_default"
  - id: "iostream_retarget_stdio"
  - id: "iostream_stdlib_config"
  - id: "silabs_core_sl_malloc"
  - id: "wisun_cli_util"
  - id: "wisun_default_radioconf"
  - id: "cli"
    instance:
      - vcom
  - id: "iostream_recommended_stream"
  - id: "rail_util_pa"
  - id: "wisun_keychain"
  - id: "wisun_silabs_certificates"
  - id: "wisun_br_dhcpv6_server"
  - id: "wisun_br_si91x"
  - id: "wisun_select"

requires:
  - name: freertos_heap_3
    condition: [freertos]
  - name: wisun_br_dhcpv6

source:
  - path: "app.c"
  - path: "app_settings.c"
  - path: "main.c"
include:
  - path: "."
    file_list:
    - path: "app.h"
    - path: "app_settings.h"
  - path: "lwip"
    file_list:
    - path: "lwipopts.h"
define:
  - name: "DEBUG_EFM_USER"
  - name: "WISUN_CLI_SAMPLE_APP"
configuration:
  - name: "SL_BOARD_ENABLE_VCOM"
    value: "1"
  - name: "SL_IOSTREAM_USART_VCOM_FLOW_CONTROL_TYPE"
    value: "usartHwFlowControlCtsAndRts"
    condition: [iostream_usart]
  - name: "SL_IOSTREAM_USART_VCOM_CONVERT_BY_DEFAULT_LF_TO_CRLF"
    value: "1"
    condition: [iostream_usart]
  - name: SL_IOSTREAM_EUSART_VCOM_CONVERT_BY_DEFAULT_LF_TO_CRLF
    value: "true"
    condition: [iostream_eusart]
  - name: SL_IOSTREAM_EUSART_VCOM_RESTRICT_ENERGY_MODE_TO_ALLOW_RECEPTION
    value: "false" # Disable this so that the chip can enter EM2/3/4
                   # and be woken by other wake sources, setting this
                   # to true adds an EM1 requirement to the Power Manager.
    condition: [iostream_eusart]
  - name: SL_IOSTREAM_EUSART_VCOM_RX_BUFFER_SIZE
    value: "128" # Increase from default 32 to account for automated command
                 # storage entry and for when long command strings are
                 # interrupted by chip interrupts.
    condition: [iostream_eusart]
  - name: SL_IOSTREAM_EUSART_VCOM_FLOW_CONTROL_TYPE
    value: "eusartHwFlowControlCtsAndRts"
    condition: [iostream_eusart]
  - name: CPU_CFG_TS_32_EN
    value: "1"
  - name: OS_CFG_DBG_EN
    value: "1"
  - name: OS_CFG_TS_EN
    value: "1"
  - name: OS_CFG_SCHED_ROUND_ROBIN_EN
    value: "1"
  - name: OS_CFG_STAT_TASK_EN
    value: "1"
  - name: OS_CFG_TASK_PROFILE_EN
    value: "1"
  - name: "OS_CFG_APP_HOOKS_EN"
    value: "1"
    condition: [micriumos_kernel]
  - name: "configUSE_POSIX_ERRNO"
    value: "1"
    condition: [freertos]
  - name: "OS_CFG_ERRNO_EN"
    value: "1"
    condition: [micriumos_kernel]
  - name: "WISUN_CLI_AUTO_SAVE"
    value: "0"
  - name: "NVM3_DEFAULT_MAX_OBJECT_SIZE"
    value: "1900"
  - name: SL_RAIL_UTIL_PTI_BAUD_RATE_HZ
    value: "3200000"
  - name: SL_CLI_VCOM_TASK_STACK_SIZE
    value: 600

template_contribution:
  - name: "cli_command"
    value:
      name: "reboot"
      handler: "app_reboot"
      help: "Reboot board"
      shortcuts:
        - name: "r"
  - name: "cli_command"
    value:
      name: "about"
      handler: "app_about"
      help: "Get info about the running app"
      shortcuts:
        - name: "a"
# -------------------------------
  - name: "cli_group"
    value:
      name: "wisun"
      help: "Wi-SUN commands"
      shortcuts:
        - name: "w"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_fan10"
      handler: "app_start_fan10"
      help: "Start the border router using FAN1.0 settings: w st10"
      shortcuts:
        - name: "st10"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_fan11"
      handler: "app_start_fan11"
      help: "Start the border router using FAN1.1 settings: w st11"
      shortcuts:
        - name: "st11"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_explicit"
      handler: "app_start_explicit"
      help: "Start the border router using explicit PHY settings: w ste"
      shortcuts:
        - name: "ste"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_ids"
      handler: "app_start_ids"
      help: "Start the border router using radio conf ids: w sti"
      shortcuts:
        - name: "sti"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_custom_fsk"
      handler: "app_start_custom_fsk"
      help: "Start the border router using custom FSK PHY settings: w scf"
      shortcuts:
        - name: "scf"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_custom_ofdm"
      handler: "app_start_custom_ofdm"
      help: "Start the border router using custom OFDM PHY settings: w scof"
      shortcuts:
        - name: "scof"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "start_custom_oqpsk"
      handler: "app_start_custom_oqpsk"
      help: "Start the border router using custom OQPSK PHY settings: w scoq"
      shortcuts:
        - name: "scoq"

  - name: "cli_command"
    value:
      group: "wisun"
      name: "stop"
      handler: "app_stop"
      help: "Stop the border router"

  - name: "cli_command"
    value:
      group: "wisun"
      name: "ping"
      handler: "app_ping"
      help: "Ping a remote host: w p"
      shortcuts:
        - name: "p"
      argument:
        - type: string
          help: "Remote address"
        - type: uint16opt
          help: "packet size in byte"

  - name: "cli_command"
    value:
      group: "wisun"
      name: "tcp_client"
      handler: "app_tcp_client"
      help: "Open a TCP client socket: w tc"
      shortcuts:
        - name: "tc"
      argument:
        - type: string
          help: "Remote address"
        - type: uint16
          help: "Remote port"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "tcp_server"
      handler: "app_tcp_server"
      help: "Open a TCP server socket: w ts"
      shortcuts:
        - name: "ts"
      argument:
        - type: uint16
          help: "Local port"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "udp_client"
      handler: "app_udp_client"
      help: "Open a UDP client socket: w uc"
      shortcuts:
        - name: "uc"
      argument:
        - type: string
          help: "Remote address"
        - type: uint16
          help: "Remote port"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "udp_server"
      handler: "app_udp_server"
      help: "Open a UDP server socket: w us"
      shortcuts:
        - name: "us"
      argument:
        - type: uint16
          help: "Local port"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_close"
      handler: "app_socket_close"
      help: "Close a socket: w sc"
      shortcuts:
        - name: "sc"
      argument:
        - type: uint32
          help: "Socket Id"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_read"
      handler: "app_socket_read"
      help: "Read from a socket: w sr"
      shortcuts:
        - name: "sr"
      argument:
        - type: uint32
          help: "Socket Id"
        - type: uint16
          help: "Amount of bytes to read"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_write"
      handler: "app_socket_write"
      help: "Write to a socket: w sw"
      shortcuts:
        - name: "sw"
      argument:
        - type: uint32
          help: "Socket Id"
        - type: string
          help: "Data to write"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_writeto"
      handler: "app_socket_writeto"
      help: "Write to a socket to a specific host: w swt"
      shortcuts:
        - name: "swt"
      argument:
        - type: uint32
          help: "Socket Id"
        - type: string
          help: "Remote address"
        - type: uint16
          help: "Remote port"
        - type: string
          help: "Data to write"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_list"
      handler: "app_socket_list"
      help: "List open sockets: w sl"
      shortcuts:
        - name: "sl"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_set_option"
      handler: "app_socket_set_option"
      help: "Set a socket option: w ss"
      shortcuts:
        - name: "ss"
      argument:
        - type: uint32
          help: "Socket Id"
        - type: string
          help: "Option"
        - type: string
          help: "Option data"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "mac_allow"
      handler: "app_mac_allow"
      help: "Add a MAC address to the list of allowed addresses, (FF:FF:FF:FF:FF:FF:FF:FF) clears the whitelist: w ma"
      shortcuts:
        - name: "ma"
      argument:
        - type: string
          help: "MAC address"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "mac_deny"
      handler: "app_mac_deny"
      help: "Add a MAC address to the list of denied addresses: w md"
      shortcuts:
        - name: "md"
      argument:
        - type: string
          help: "MAC address"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "socket_get_option"
      handler: "app_socket_get_option"
      help: "Get a socket option: w sg"
      shortcuts:
        - name: "sg"
      argument:
        - type: wildcard
          help: empty | [uint32] Socket Id [string] Option
  - name: "cli_command"
    value:
      group: "wisun"
      name: "reset_statistics"
      handler: "app_reset_statistics"
      help: "Reset the statistics: w rs"
      shortcuts:
        - name: "rs"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "set_trace_level"
      handler: "app_set_trace_level"
      help: "Set the trace level: w tl"
      shortcuts:
        - name: "tl"
      argument:
        - type: string
          help: "List of ID,level; such as 1,none;4,info to configure group ID 1 with no log and group ID 4 with INFO level. Can also use all,info to set all group to INFO level"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "set_lfn_support"
      handler: "app_set_lfn_support"
      help: "configure LFN support"
      argument:
        - type: uint8
          help: "lfn_limit: Number of locally supported LFN"
        - type: uint8
          help: "lfn_support_pan: Enable or disable LFN support at PAN (0|1)"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "set_dhcp_vendor_data"
      handler: "app_set_dhcp_vendor_data"
      help: "add vendor data to include in DHCP replies"
      shortcuts:
        - name: "dhcpvd"
      argument:
        - type: uint32
          help: "enterprise_number: Vendor's registered Enterprise Number"
        - type: hex
          help: "data: Suboption data written in hex format"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "pan_defect_advertise"
      handler: "app_pan_defect_advertise"
      help: "Set PAN defect advertisement"
      argument:
        - type: uint8
          help: "defect_advertise: True to start PAN Defect procedure, false to stop it"
        - type: uint32
          help: "minimum_scan_time_s: Minimum duration after which devices are allowed to switch their PAN if an alternative one is available."
        - type: uint32
          help: "maximum_scan_time_s: Duration after which devices should systemically switch to the alternative PAN if one is available."
  - name: "cli_command"
    value:
      group: "wisun"
      name: "mode_switch"
      handler: "app_mode_switch"
      help: "configure mode witch: w ms"
      shortcuts:
        - name: "ms"
      argument:
        - type: uint8
          help: "mode: 0=disabled, 1=enabled, 2=default"
        - type: uint8
          help: "PhyModeId"
        - type: stringopt
          help: "neighbor MAC address (optional)"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "trigger"
      handler: "app_trigger_frame"
      help: "Trigger the transmission of a frame"
      shortcuts:
        - name: "tx"
      argument:
        - type: string
          help: "frame type"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "getsockname"
      handler: "app_getsockname"
      help: "Get socket's local Ip address"
      argument:
        - type: uint32
          help: "Socket Id"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "getpeername"
      handler: "app_getpeername"
      help: "Get socket's peer Ip address"
      argument:
        - type: uint32
          help: "Socket Id"
  - name: "cli_command"
    value:
      group: "wisun"
      name: "set_phy_sens"
      handler: "app_set_phy_sensitivity"
      help: "Set the sensitivity for the given PHY mode ID"
      argument:
        - type: uint8
          help: "PHY mode ID"
        - type: int16
          help: "Sensitivity in dBm"
# -------------------------------
  - name: cli_group
    value:
      name: wifi
      help: Wi-Fi commands
    condition: [wisun_br_wifi]
  - name: cli_command
    value:
      group: wifi
      name: connect
      handler: app_wifi_connect
      help: Connect to Wi-FI AP
    condition: [wisun_br_wifi]
  - name: cli_command
    value:
      group: wifi
      name: disconnect
      handler: app_wifi_disconnect
      help: Disconnect from Wi-FI AP
    condition: [wisun_br_wifi]

readme:
  - path: doc/readme.md

other_file:
  - path: doc/readme_img0.png

ui_hints:
  highlight:
    - path: doc/readme.md
      focus: true

tag:
  - prebuilt_demo

filter:
  - name: "Wireless Technology"
    value: ["Wi-SUN"]
  - name: "Device Type"
    value: ["SoC"]
  - name: "Project Difficulty"
    value: ["Advanced"]
